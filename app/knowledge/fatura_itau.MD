# Knowledge Base ‚Äì Fatura de Cart√£o de Cr√©dito Ita√∫ (Brasil)

Este documento descreve regras, padr√µes e exclus√µes para extra√ß√£o correta de despesas
em faturas de cart√£o de cr√©dito do Ita√∫.

Seu objetivo √© ajudar o LLM a:
- Extrair somente compras reais
- Evitar duplica√ß√µes
- Ignorar pagamentos, juros e textos explicativos

---

## 1. O QUE √â UMA TRANSA√á√ÉO V√ÅLIDA

Uma transa√ß√£o v√°lida representa uma **compra ou saque** feito no cart√£o.

Uma transa√ß√£o v√°lida **SEMPRE** possui:
- Uma data no formato DD/MM
- Um nome de estabelecimento comercial
- Um valor positivo
- Est√° localizada na se√ß√£o:
  **"Lan√ßamentos: compras e saques"**

Exemplo v√°lido:
28/11 IFD*60463747CAMILLYLA 53,98

yaml
Copiar c√≥digo

---

## 2. O QUE N√ÉO DEVE SER EXTRA√çDO (REGRA CR√çTICA)

‚ö†Ô∏è **NUNCA extraia como despesa**:

### Pagamentos e cr√©ditos
- PAGAMENTOPIX
- Pagamento efetuado
- Total dos pagamentos
- Cr√©dito
- Estorno

Exemplo inv√°lido:
07/11 PAGAMENTOPIX -150,19

yaml
Copiar c√≥digo

---

### Juros, encargos e informa√ß√µes financeiras
- Juros do rotativo
- Juros de mora
- Multa por atraso
- IOF
- CET
- Encargos financeiros
- Cr√©dito rotativo

---

### Textos explicativos que causam duplica√ß√£o
‚ö†Ô∏è Estes textos **N√ÉO representam compras**, mesmo que apare√ßam pr√≥ximos a valores:

- Novo teto de juros do cart√£o de cr√©dito
- Limite m√°ximo de juros
- Juros e encargos financeiros at√© o momento
- % sobre o limite m√°ximo de juros
- Simula√ß√£o de compras parceladas
- Limites de cr√©dito
- Limite dispon√≠vel
- Limite total utilizado

‚ùå Estes textos costumam gerar **duplicatas falsas** e devem ser ignorados.

---

## 3. DELIMITA√á√ÉO DE CONTEXTO (MUITO IMPORTANTE)

Apenas o conte√∫do **ENTRE** os marcadores abaixo pode conter transa√ß√µes:

### In√≠cio v√°lido
Lan√ßamentos: compras e saques

shell
Copiar c√≥digo

### Fim v√°lido
Lan√ßamentos no cart√£o

nginx
Copiar c√≥digo
ou
Total dos lan√ßamentos atuais

yaml
Copiar c√≥digo

üëâ Qualquer texto fora desse intervalo **n√£o cont√©m despesas**.

---

## 4. PADR√ÉO REAL DAS COMPRAS

Formato t√≠pico:
DD/MM NOME_DO_ESTABELECIMENTO VALOR

java
Copiar c√≥digo

Pode haver texto adicional abaixo (cidade / categoria), que deve ser ignorado.

Exemplo:
26/11 IFD*VSSERVICOSDEALIA 122,88
restaurante city

yaml
Copiar c√≥digo

‚úÖ Apenas a primeira linha representa a transa√ß√£o.

---

## 5. DEDUPLICA√á√ÉO (REGRA OBRIGAT√ìRIA)

Considere duas transa√ß√µes duplicadas se tiverem:
- Mesma data
- Mesmo estabelecimento (normalizado)
- Mesmo valor

‚ö†Ô∏è Mesmo que apare√ßam em contextos diferentes do texto.

---

## 6. EXEMPLOS POSITIVOS

```json
{
  "date": "2025-11-26",
  "description": "IFD*VSSERVICOSDEALIA",
  "amount": 122.88,
  "installment": null,
  "currency": "BRL"
}
7. EXEMPLOS NEGATIVOS (N√ÉO EXTRAIR)
text
Copiar c√≥digo
Novo teto de juros do cart√£o de cr√©dito
Limite m√°ximo de juros 0,00
P Total dos pagamentos -150,19
8. OBJETIVO FINAL DO MODELO
Extrair somente compras reais, com alta precis√£o, evitando:

Pagamentos

Repeti√ß√µes

Reinterpreta√ß√£o de textos financeiros

Se houver d√∫vida, prefira n√£o extrair.